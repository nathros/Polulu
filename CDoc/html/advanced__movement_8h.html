<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Team Rocket Robotics: advanced_movement.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Team Rocket Robotics
   &#160;<span id="projectnumber">GroupVersion</span>
   </div>
   <div id="projectbrief">Team Rocket, blast off at the speed of light!</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">advanced_movement.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Pololu advanced movement module header.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="coordinate_8h_source.html">coordinate.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="odometry_8h_source.html">odometry.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for advanced_movement.h:</div>
<div class="dyncontent">
<div class="center"><img src="advanced__movement_8h__incl.png" border="0" usemap="#advanced__movement_8h" alt=""/></div>
<map name="advanced__movement_8h" id="advanced__movement_8h">
<area shape="rect" id="node3" href="coordinate_8h.html" title="Coordinate record module header." alt="" coords="5,83,99,112"/><area shape="rect" id="node5" href="odometry_8h.html" title="Wheel encoder based odometery module (header file)" alt="" coords="123,83,208,112"/></map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="advanced__movement_8h__dep__incl.png" border="0" usemap="#advanced__movement_8hdep" alt=""/></div>
<map name="advanced__movement_8hdep" id="advanced__movement_8hdep">
<area shape="rect" id="node3" href="advanced__movement_8c.html" title="Pololu advanced movement module." alt="" coords="5,83,163,112"/><area shape="rect" id="node5" href="coordinate_8c.html" title="Coordinate record module." alt="" coords="187,83,280,112"/><area shape="rect" id="node7" href="main_8h.html" title="main.h" alt="" coords="304,83,365,112"/><area shape="rect" id="node11" href="main__test__line_8c.html" title="main_test_line.c" alt="" coords="389,83,507,112"/><area shape="rect" id="node13" href="odometry_8c.html" title="Wheel encoder based odometry module (source)" alt="" coords="531,83,616,112"/><area shape="rect" id="node15" href="pid_8c.html" title="Line following code." alt="" coords="640,83,691,112"/><area shape="rect" id="node9" href="main_8c.html" title="basic step by step demo code" alt="" coords="304,160,365,189"/></map>
</div>
</div>
<p><a href="advanced__movement_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a20cdaa738bfcb5048f75f3bf3d3d9df0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="advanced__movement_8h.html#a20cdaa738bfcb5048f75f3bf3d3d9df0">adv_exit</a> ()</td></tr>
<tr class="memdesc:a20cdaa738bfcb5048f75f3bf3d3d9df0"><td class="mdescLeft">&#160;</td><td class="mdescRight">set the abort / exit flag for advanced movement functions  <a href="#a20cdaa738bfcb5048f75f3bf3d3d9df0"></a><br/></td></tr>
<tr class="memitem:a3e41f7d4e342aa8ea83f905cb3cbd7d0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="advanced__movement_8h.html#a3e41f7d4e342aa8ea83f905cb3cbd7d0">adv_rpm_update</a> (<a class="el" href="structRPM.html">RPM</a> rpm)</td></tr>
<tr class="memdesc:a3e41f7d4e342aa8ea83f905cb3cbd7d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">update the local rpm record  <a href="#a3e41f7d4e342aa8ea83f905cb3cbd7d0"></a><br/></td></tr>
<tr class="memitem:a2f92087fcefcdd3603d6ecf3dd24d275"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="advanced__movement_8h.html#a2f92087fcefcdd3603d6ecf3dd24d275">adv_angle_update</a> (int n)</td></tr>
<tr class="memdesc:a2f92087fcefcdd3603d6ecf3dd24d275"><td class="mdescLeft">&#160;</td><td class="mdescRight">update the normalised angle value for the pid angle following  <a href="#a2f92087fcefcdd3603d6ecf3dd24d275"></a><br/></td></tr>
<tr class="memitem:acb38670d4902890b481e832b39168537"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="advanced__movement_8h.html#acb38670d4902890b481e832b39168537">adv_travel</a> (float distance)</td></tr>
<tr class="memdesc:acb38670d4902890b481e832b39168537"><td class="mdescLeft">&#160;</td><td class="mdescRight">Move the robot for certain distance.  <a href="#acb38670d4902890b481e832b39168537"></a><br/></td></tr>
<tr class="memitem:a4bbd42daaf19c44d051e1afde0a09576"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="advanced__movement_8h.html#a4bbd42daaf19c44d051e1afde0a09576">adv_move_polar</a> (float distance, int bearing)</td></tr>
<tr class="memdesc:a4bbd42daaf19c44d051e1afde0a09576"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate and move (Non-PID version)  <a href="#a4bbd42daaf19c44d051e1afde0a09576"></a><br/></td></tr>
<tr class="memitem:a1f84062caee0d0c04e26c0a5ed5aa6f5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="advanced__movement_8h.html#a1f84062caee0d0c04e26c0a5ed5aa6f5">adv_move</a> (<a class="el" href="structCoordinate.html">Coordinate</a> target)</td></tr>
<tr class="memdesc:a1f84062caee0d0c04e26c0a5ed5aa6f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">move to a location (Non-PID version)  <a href="#a1f84062caee0d0c04e26c0a5ed5aa6f5"></a><br/></td></tr>
<tr class="memitem:a5a94e3d9dce99e8d81d51515fa9c3ed6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="advanced__movement_8h.html#a5a94e3d9dce99e8d81d51515fa9c3ed6">adv_move_pid_polar</a> (float distance, int bearing)</td></tr>
<tr class="memdesc:a5a94e3d9dce99e8d81d51515fa9c3ed6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rotate and move (PID version)  <a href="#a5a94e3d9dce99e8d81d51515fa9c3ed6"></a><br/></td></tr>
<tr class="memitem:a32ecfecc38758df0d69b18aafa5cc470"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="advanced__movement_8h.html#a32ecfecc38758df0d69b18aafa5cc470">adv_move_pid</a> (<a class="el" href="structCoordinate.html">Coordinate</a> target)</td></tr>
<tr class="memdesc:a32ecfecc38758df0d69b18aafa5cc470"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementing function for straight line movement (based on mouse data)  <a href="#a32ecfecc38758df0d69b18aafa5cc470"></a><br/></td></tr>
<tr class="memitem:a29fde422d15d810849e70bbaf9c785a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="advanced__movement_8h.html#a29fde422d15d810849e70bbaf9c785a3">adv_motors_rpm</a> (float distance)</td></tr>
<tr class="memdesc:a29fde422d15d810849e70bbaf9c785a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Implementing PID function for straight line movement based on wheel encoders.  <a href="#a29fde422d15d810849e70bbaf9c785a3"></a><br/></td></tr>
<tr class="memitem:a6846eb629cadb04c4e4b9ad3fda2ad44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="advanced__movement_8h.html#a6846eb629cadb04c4e4b9ad3fda2ad44">adv_print_rmp</a> ()</td></tr>
<tr class="memdesc:a6846eb629cadb04c4e4b9ad3fda2ad44"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print readings from <a class="el" href="structRPM.html" title="Motor RPM record structure.">RPM</a>.  <a href="#a6846eb629cadb04c4e4b9ad3fda2ad44"></a><br/></td></tr>
</table>
<a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Pololu advanced movement module header. </p>
<dl class="section author"><dt>Author</dt><dd>Fufu Fang </dd>
<dd>
Sam Gamble </dd></dl>

<p>Definition in file <a class="el" href="advanced__movement_8h_source.html">advanced_movement.h</a>.</p>
</div><h2>Function Documentation</h2>
<a class="anchor" id="a2f92087fcefcdd3603d6ecf3dd24d275"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adv_angle_update </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update the normalised angle value for the pid angle following </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>the target angle (between -2000 to 2000) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Fufu Fang </dd></dl>

<p>Definition at line <a class="el" href="advanced__movement_8c_source.html#l00041">41</a> of file <a class="el" href="advanced__movement_8c_source.html">advanced_movement.c</a>.</p>

<p>References <a class="el" href="advanced__movement_8c_source.html#l00030">g_pid_angle</a>.</p>

<p>Referenced by <a class="el" href="coordinate_8c_source.html#l00045">coordinate_update()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <a class="code" href="advanced__movement_8c.html#a264d5899006eccc0190c0fe9a9370e27">g_pid_angle</a> = n;</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="advanced__movement_8h_a2f92087fcefcdd3603d6ecf3dd24d275_icgraph.png" border="0" usemap="#advanced__movement_8h_a2f92087fcefcdd3603d6ecf3dd24d275_icgraph" alt=""/></div>
<map name="advanced__movement_8h_a2f92087fcefcdd3603d6ecf3dd24d275_icgraph" id="advanced__movement_8h_a2f92087fcefcdd3603d6ecf3dd24d275_icgraph">
<area shape="rect" id="node3" href="coordinate_8h.html#aa45013e6e2bd7e213e997d0bdaa8dad3" title="Update global Coordinate record." alt="" coords="181,32,309,61"/><area shape="rect" id="node5" href="mouse_8h.html#adeb5e1f377406ceb59106ae6318a728b" title="callback function for mouse movement" alt="" coords="359,5,473,35"/><area shape="rect" id="node13" href="odometry_8c.html#a05b1452a03ab9bac0c107d34e3c97541" title="submit wheel encoder&#39;s data" alt="" coords="359,59,473,88"/><area shape="rect" id="node7" href="mouse_8h.html#a04727e4cf581d3df014c421c584726aa" title="Setup the mouse subsystem." alt="" coords="531,5,629,35"/><area shape="rect" id="node9" href="main_8h.html#a02fd73d861ef2e4aabb38c0c9ff82947" title="All system Initialisation." alt="" coords="735,5,772,35"/><area shape="rect" id="node11" href="main_8c.html#acdef7a1fd863a6d3770c1268cb06add3" title="main" alt="" coords="869,5,920,35"/><area shape="rect" id="node15" href="odometry_8h.html#a1969509b35503f205065612f46c6da7c" title="increase the internal encoder count" alt="" coords="523,59,637,88"/><area shape="rect" id="node17" href="gpio_8h.html#af8da7f07629d00e7f39d86df2ee1470c" title="Interrupt Service Routine for GPIO ports." alt="" coords="685,59,821,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a20cdaa738bfcb5048f75f3bf3d3d9df0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adv_exit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set the abort / exit flag for advanced movement functions </p>
<p>If the system is in a travel loop, it will break out the loop. </p>
<dl class="section author"><dt>Author</dt><dd>Sam Gamble </dd></dl>

<p>Definition at line <a class="el" href="advanced__movement_8c_source.html#l00046">46</a> of file <a class="el" href="advanced__movement_8c_source.html">advanced_movement.c</a>.</p>

<p>References <a class="el" href="advanced__movement_8c_source.html#l00031">g_exit_flag</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <a class="code" href="advanced__movement_8c.html#a2bc032c2ec766050ea8081ff97b533ea">g_exit_flag</a> = 1;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a29fde422d15d810849e70bbaf9c785a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adv_motors_rpm </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>distance</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementing PID function for straight line movement based on wheel encoders. </p>
<p>untested and crazy stuff might happen depeding on the PID constancts set </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">Distance</td><td>to travel (Float) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Sam Gamble </dd></dl>

<p>Definition at line <a class="el" href="advanced__movement_8c_source.html#l00172">172</a> of file <a class="el" href="advanced__movement_8c_source.html">advanced_movement.c</a>.</p>

<p>References <a class="el" href="debug_8c_source.html#l00016">dbg_printf()</a>, <a class="el" href="coordinate_8c_source.html#l00093">distance_clear()</a>, <a class="el" href="coordinate_8c_source.html#l00098">distance_read()</a>, <a class="el" href="advanced__movement_8c_source.html#l00031">g_exit_flag</a>, <a class="el" href="motor_8c_source.html#l00056">internal_motor_send()</a>, <a class="el" href="advanced__movement_8c_source.html#l00023">Kd_rpm</a>, <a class="el" href="advanced__movement_8c_source.html#l00024">Ki_rpm</a>, <a class="el" href="advanced__movement_8c_source.html#l00022">Kp_rpm</a>, <a class="el" href="odometry_8h_source.html#l00025">RPM::left</a>, <a class="el" href="motor_8h_source.html#l00048">MOTOR_LEFT</a>, <a class="el" href="motor_8c_source.html#l00222">motor_read()</a>, <a class="el" href="motor_8h_source.html#l00049">MOTOR_RIGHT</a>, <a class="el" href="motor_8c_source.html#l00237">motors_move()</a>, <a class="el" href="motor_8c_source.html#l00231">motors_stop()</a>, <a class="el" href="odometry_8h_source.html#l00026">RPM::right</a>, <a class="el" href="advanced__movement_8c_source.html#l00027">RPM_MAX</a>, <a class="el" href="advanced__movement_8c_source.html#l00028">RPM_MIN</a>, <a class="el" href="advanced__movement_8c_source.html#l00026">SCALE_RPM</a>, and <a class="el" href="advanced__movement_8c_source.html#l00025">TARGET_RPM</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">float</span> travelled         = 0;</div>
<div class="line">        <span class="keywordtype">float</span> prv_error_left    = 0;</div>
<div class="line">        <span class="keywordtype">float</span> prv_error_right   = 0;</div>
<div class="line">        <span class="keywordtype">float</span> error_left        = 0;</div>
<div class="line">        <span class="keywordtype">float</span> error_right       = 0;</div>
<div class="line">        <span class="keywordtype">float</span> deriv_left        = 0;</div>
<div class="line">        <span class="keywordtype">float</span> deriv_right       = 0;</div>
<div class="line">        <span class="keywordtype">float</span> ingrl_left        = 0;</div>
<div class="line">        <span class="keywordtype">float</span> ingrl_right       = 0;</div>
<div class="line">        <span class="keywordtype">float</span> calc_l            = 0;</div>
<div class="line">        <span class="keywordtype">float</span> calc_r            = 0;</div>
<div class="line">        <span class="keywordtype">int</span> motor_spd_l         = 30;</div>
<div class="line">        <span class="keywordtype">int</span> motor_spd_r         = 30;</div>
<div class="line"></div>
<div class="line">       <span class="comment">// float  current_right;</span></div>
<div class="line">        <span class="comment">//float  current_left;</span></div>
<div class="line">        <a class="code" href="advanced__movement_8c.html#a2bc032c2ec766050ea8081ff97b533ea">g_exit_flag</a> = 0;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="motor_8c.html#a9327d3b425e2e0e49630118f7153eb60" title="Move both motors.">motors_move</a>(30);</div>
<div class="line"></div>
<div class="line">       <span class="comment">// dbg_printf(&quot;set motors\r\n&quot;);</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="comment">//-Correcting for BOTH motors RPM-------------------------------------</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <a class="code" href="coordinate_8c.html#a5904eb71d7fc2687a693f0518775cb5a" title="clear distance record.">distance_clear</a>();</div>
<div class="line">        <span class="keywordflow">while</span>(travelled &lt;= distance){</div>
<div class="line">            <span class="keywordflow">if</span>(<a class="code" href="advanced__movement_8c.html#a2bc032c2ec766050ea8081ff97b533ea">g_exit_flag</a>)</div>
<div class="line">                <span class="keywordflow">return</span>;</div>
<div class="line"></div>
<div class="line">            <a class="code" href="debug_8c.html#a5cac9a3a2f2d7c55aa4ede6ba71bf8be" title="printf function for the debugging console">dbg_printf</a>(<span class="stringliteral">&quot;-pid loop-\r\n&quot;</span>);</div>
<div class="line">            travelled = <a class="code" href="coordinate_8c.html#a006f5a8a7a96dd826d00b123b2e36bc3" title="read total distance travelled">distance_read</a>();</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">            <span class="comment">//Proportianl</span></div>
<div class="line">            error_left      = <a class="code" href="advanced__movement_8c.html#a226b7a7f368aa03cf2e233aa693d4c78">TARGET_RPM</a> - <a class="code" href="advanced__movement_8c.html#af5b0c7c50a70c6118aa12887fee0e722">g_rpm</a>.<a class="code" href="structRPM.html#a4caca26b4332b8a38bd0268e015519c8" title="rpm of left motor">left</a>;</div>
<div class="line">            error_right     = <a class="code" href="advanced__movement_8c.html#a226b7a7f368aa03cf2e233aa693d4c78">TARGET_RPM</a> - <a class="code" href="advanced__movement_8c.html#af5b0c7c50a70c6118aa12887fee0e722">g_rpm</a>.<a class="code" href="structRPM.html#aacfc09ab6ae0ab2e58f30d0e4c7e9bfe" title="rpm of right motor">right</a>;</div>
<div class="line"></div>
<div class="line">             <span class="comment">//Ignore crazy values</span></div>
<div class="line">            <span class="keywordflow">if</span>(<a class="code" href="advanced__movement_8c.html#af5b0c7c50a70c6118aa12887fee0e722">g_rpm</a>.<a class="code" href="structRPM.html#a4caca26b4332b8a38bd0268e015519c8" title="rpm of left motor">left</a> &lt;= 0) error_left      = 0;</div>
<div class="line">            <span class="keywordflow">if</span>(<a class="code" href="advanced__movement_8c.html#af5b0c7c50a70c6118aa12887fee0e722">g_rpm</a>.<a class="code" href="structRPM.html#aacfc09ab6ae0ab2e58f30d0e4c7e9bfe" title="rpm of right motor">right</a> &lt;= 0) error_right    = 0;</div>
<div class="line"></div>
<div class="line">            <span class="comment">//Derivative --not sure about dt div (wikipedia told me so, THERFORE IT MUST BE TRUE!)</span></div>
<div class="line">            deriv_left      = (prv_error_left - error_left);</div>
<div class="line">            deriv_right     = (prv_error_right - error_right);</div>
<div class="line"></div>
<div class="line">            <span class="comment">//Intergral</span></div>
<div class="line">            ingrl_left      += error_left;</div>
<div class="line">            ingrl_right     += error_right;</div>
<div class="line"></div>
<div class="line">            <span class="comment">//perform calc</span></div>
<div class="line">            calc_l          = (error_left * <a class="code" href="advanced__movement_8c.html#a6f06158fb77d283ccfbc4b0e2b0a839b">Kp_rpm</a>) + (ingrl_left * <a class="code" href="advanced__movement_8c.html#ad4700d3d1395b5c0d3532a348e6e8b42">Ki_rpm</a>) + (deriv_left * <a class="code" href="advanced__movement_8c.html#ae9aeb6d347577dfe70827072aa55eb6b">Kd_rpm</a>);</div>
<div class="line">            calc_r          = (error_right * <a class="code" href="advanced__movement_8c.html#a6f06158fb77d283ccfbc4b0e2b0a839b">Kp_rpm</a>) + (ingrl_right * Ki_rpm) + (deriv_right * <a class="code" href="advanced__movement_8c.html#ae9aeb6d347577dfe70827072aa55eb6b">Kd_rpm</a>);</div>
<div class="line"></div>
<div class="line">            <span class="comment">//read current motor values</span></div>
<div class="line">            motor_spd_l     = <a class="code" href="motor_8c.html#a9354222349ea5fb2675f8bdb4b9241fc" title="Read motor speed.">motor_read</a>(<a class="code" href="motor_8h.html#a3bc45ff9023afee0cc287274e972d7cea5bf5acca4f368c777491da2a6109c23d">MOTOR_LEFT</a>);</div>
<div class="line">            motor_spd_r     = <a class="code" href="motor_8c.html#a9354222349ea5fb2675f8bdb4b9241fc" title="Read motor speed.">motor_read</a>(<a class="code" href="motor_8h.html#a3bc45ff9023afee0cc287274e972d7ceae977a35627395c6f492fc57e47a4b079">MOTOR_RIGHT</a>);</div>
<div class="line"></div>
<div class="line">            <span class="comment">//Calculate new Motor Values</span></div>
<div class="line">            motor_spd_l     = motor_spd_l + (int)(calc_l * <a class="code" href="advanced__movement_8c.html#ac87e8938cd31d12ac08d7285e8845eda">SCALE_RPM</a>);</div>
<div class="line">            motor_spd_r     = motor_spd_r + (int)(calc_r * <a class="code" href="advanced__movement_8c.html#ac87e8938cd31d12ac08d7285e8845eda">SCALE_RPM</a>);</div>
<div class="line"></div>
<div class="line">            <span class="comment">//Cap values if they exced MIN/MAX threshold</span></div>
<div class="line">            <span class="keywordflow">if</span>(motor_spd_r &lt; <a class="code" href="advanced__movement_8c.html#afc05771487f188ffa40b6620afc1a9bc">RPM_MIN</a>)</div>
<div class="line">                motor_spd_r = <a class="code" href="advanced__movement_8c.html#afc05771487f188ffa40b6620afc1a9bc">RPM_MIN</a>;</div>
<div class="line">            <span class="keywordflow">if</span>(motor_spd_l &lt; <a class="code" href="advanced__movement_8c.html#afc05771487f188ffa40b6620afc1a9bc">RPM_MIN</a>)</div>
<div class="line">                 motor_spd_l = <a class="code" href="advanced__movement_8c.html#afc05771487f188ffa40b6620afc1a9bc">RPM_MIN</a>;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span>(motor_spd_r &gt; <a class="code" href="advanced__movement_8c.html#a03f0cc69336f88fcd5943808f19bab28">RPM_MAX</a>)</div>
<div class="line">                motor_spd_r = <a class="code" href="advanced__movement_8c.html#a03f0cc69336f88fcd5943808f19bab28">RPM_MAX</a>;</div>
<div class="line">            <span class="keywordflow">if</span>(motor_spd_l &gt; <a class="code" href="advanced__movement_8c.html#a03f0cc69336f88fcd5943808f19bab28">RPM_MAX</a>)</div>
<div class="line">                motor_spd_l = <a class="code" href="advanced__movement_8c.html#a03f0cc69336f88fcd5943808f19bab28">RPM_MAX</a>;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            #ifdef ADV_MOV_DBG</span></div>
<div class="line"><span class="preprocessor"></span>            <a class="code" href="debug_8c.html#a5cac9a3a2f2d7c55aa4ede6ba71bf8be" title="printf function for the debugging console">dbg_printf</a>(<span class="stringliteral">&quot;motor_spd_l: %d   motor_spd_r: %d\r\n&quot;</span> ,motor_spd_l ,motor_spd_r);</div>
<div class="line"><span class="preprocessor">            #endif</span></div>
<div class="line"><span class="preprocessor"></span>            <span class="comment">//Set new Motor Values</span></div>
<div class="line">            <a class="code" href="motor_8c.html#a0bc2624928b5e9869ce6946fb2042fd8" title="private function: send a command to motor">internal_motor_send</a>(<a class="code" href="motor_8h.html#a3bc45ff9023afee0cc287274e972d7cea5bf5acca4f368c777491da2a6109c23d">MOTOR_LEFT</a>, motor_spd_l);</div>
<div class="line">            <a class="code" href="motor_8c.html#a0bc2624928b5e9869ce6946fb2042fd8" title="private function: send a command to motor">internal_motor_send</a>(<a class="code" href="motor_8h.html#a3bc45ff9023afee0cc287274e972d7ceae977a35627395c6f492fc57e47a4b079">MOTOR_RIGHT</a>, motor_spd_r);</div>
<div class="line"></div>
<div class="line">            <span class="comment">//save current error</span></div>
<div class="line">            prv_error_left  = error_left;</div>
<div class="line">            prv_error_right = error_right;</div>
<div class="line"></div>
<div class="line"><span class="preprocessor">            #ifdef ADV_MOV_DBG</span></div>
<div class="line"><span class="preprocessor"></span>            <a class="code" href="debug_8c.html#a5cac9a3a2f2d7c55aa4ede6ba71bf8be" title="printf function for the debugging console">dbg_printf</a>(<span class="stringliteral">&quot;l_rpm_measured: %f   l_rpm_error: %f\r\n&quot;</span> ,<a class="code" href="advanced__movement_8c.html#af5b0c7c50a70c6118aa12887fee0e722">g_rpm</a>.<a class="code" href="structRPM.html#a4caca26b4332b8a38bd0268e015519c8" title="rpm of left motor">left</a> ,error_left);</div>
<div class="line">            <a class="code" href="debug_8c.html#a5cac9a3a2f2d7c55aa4ede6ba71bf8be" title="printf function for the debugging console">dbg_printf</a>(<span class="stringliteral">&quot;r_rpm_measured: %f   r_rpm_error: %f\r\n&quot;</span> ,<a class="code" href="advanced__movement_8c.html#af5b0c7c50a70c6118aa12887fee0e722">g_rpm</a>.<a class="code" href="structRPM.html#aacfc09ab6ae0ab2e58f30d0e4c7e9bfe" title="rpm of right motor">right</a> ,error_right);</div>
<div class="line"><span class="preprocessor">            #endif</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <a class="code" href="debug_8c.html#a5cac9a3a2f2d7c55aa4ede6ba71bf8be" title="printf function for the debugging console">dbg_printf</a>(<span class="stringliteral">&quot;end loop&quot;</span>);</div>
<div class="line">        <a class="code" href="motor_8c.html#a2028f6e7acaeca3139534961fb804889" title="Stop both motors.">motors_stop</a>();</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="advanced__movement_8h_a29fde422d15d810849e70bbaf9c785a3_cgraph.png" border="0" usemap="#advanced__movement_8h_a29fde422d15d810849e70bbaf9c785a3_cgraph" alt=""/></div>
<map name="advanced__movement_8h_a29fde422d15d810849e70bbaf9c785a3_cgraph" id="advanced__movement_8h_a29fde422d15d810849e70bbaf9c785a3_cgraph">
<area shape="rect" id="node3" href="debug_8c.html#a5cac9a3a2f2d7c55aa4ede6ba71bf8be" title="printf function for the debugging console" alt="" coords="329,57,407,87"/><area shape="rect" id="node5" href="coordinate_8c.html#a5904eb71d7fc2687a693f0518775cb5a" title="clear distance record." alt="" coords="173,59,280,88"/><area shape="rect" id="node7" href="coordinate_8c.html#a006f5a8a7a96dd826d00b123b2e36bc3" title="read total distance travelled" alt="" coords="176,5,277,35"/><area shape="rect" id="node10" href="motor_8c.html#a0bc2624928b5e9869ce6946fb2042fd8" title="private function: send a command to motor" alt="" coords="456,201,595,231"/><area shape="rect" id="node14" href="motor_8c.html#a9354222349ea5fb2675f8bdb4b9241fc" title="Read motor speed." alt="" coords="184,213,269,243"/><area shape="rect" id="node16" href="motor_8c.html#a9327d3b425e2e0e49630118f7153eb60" title="Move both motors." alt="" coords="176,320,277,349"/><area shape="rect" id="node24" href="motor_8c.html#a2028f6e7acaeca3139534961fb804889" title="Stop both motors." alt="" coords="180,267,273,296"/><area shape="rect" id="node12" href="uart_8c.html#abfe57cac5619ef3c3aa92250740e3cc5" title="Blocking send function." alt="" coords="644,201,745,231"/><area shape="rect" id="node18" href="motor_8c.html#a6b8738722a7fad99c5e6b9be4e53d1b7" title="Speed limiter." alt="" coords="472,295,579,324"/><area shape="rect" id="node20" href="motor_8c.html#ad61876852438f35d82769b704e6e8e37" title="Set motor speed." alt="" coords="328,268,408,297"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1f84062caee0d0c04e26c0a5ed5aa6f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adv_move </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCoordinate.html">Coordinate</a>&#160;</td>
          <td class="paramname"><em>target</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>move to a location (Non-PID version) </p>
<p>Rotates to face angle of travel, then move a certain distance, then rotate to face the final angle. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">target</td><td>the target coordinate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Fufu Fang</dd></dl>
<dl class="section note"><dt>Note</dt><dd>For calculating the direction of travel, the angle reference comes from coordinate.c.However the rotation angle record actually comes from <a class="el" href="motor_8c.html" title="Polulu motor controller.">motor.c</a>! </dd></dl>

<p>Definition at line <a class="el" href="advanced__movement_8c_source.html#l00076">76</a> of file <a class="el" href="advanced__movement_8c_source.html">advanced_movement.c</a>.</p>

<p>References <a class="el" href="advanced__movement_8c_source.html#l00051">adv_travel()</a>, <a class="el" href="coordinate_8c_source.html#l00088">coordinate_read()</a>, <a class="el" href="debug_8c_source.html#l00016">dbg_printf()</a>, <a class="el" href="motor_8c_source.html#l00285">motor_rot_abs()</a>, <a class="el" href="coordinate_8h_source.html#l00020">Coordinate::t</a>, <a class="el" href="common_8c_source.html#l00016">toDegree()</a>, <a class="el" href="coordinate_8h_source.html#l00018">Coordinate::x</a>, and <a class="el" href="coordinate_8h_source.html#l00019">Coordinate::y</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <a class="code" href="structCoordinate.html" title="Coordinate record structure.">Coordinate</a> current = <a class="code" href="coordinate_8c.html#af0c0898bb2b39bd4946e5c9a0911971d" title="read global coordinate record">coordinate_read</a>();</div>
<div class="line">    <span class="keywordtype">int</span> dx = target.<a class="code" href="structCoordinate.html#a514c8968b1d03f65e76c9cc9566ee4cc" title="distance of x in cm">x</a> - current.<a class="code" href="structCoordinate.html#a514c8968b1d03f65e76c9cc9566ee4cc" title="distance of x in cm">x</a>;</div>
<div class="line">    <span class="keywordtype">int</span> dy = target.<a class="code" href="structCoordinate.html#a1a7d11305e68c5bfba2b9d4569d4b6ef" title="distance of y in cm">y</a> - current.<a class="code" href="structCoordinate.html#a1a7d11305e68c5bfba2b9d4569d4b6ef" title="distance of y in cm">y</a>;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* defensive programming, error avoidance) */</span></div>
<div class="line">    <span class="keywordflow">if</span> ( (dy == 0) &amp;&amp; (dx == 0) ){</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">float</span> distance = sqrt(dx*dx + dy*dy);</div>
<div class="line">    <span class="keywordtype">float</span> direction = atan2(dy, dx);</div>
<div class="line"><span class="preprocessor">    #ifdef ADV_MOV_DBG</span></div>
<div class="line"><span class="preprocessor"></span>    <a class="code" href="debug_8c.html#a5cac9a3a2f2d7c55aa4ede6ba71bf8be" title="printf function for the debugging console">dbg_printf</a>(<span class="stringliteral">&quot;ADV_MOVE: Starting, Rotating to %f\r\n&quot;</span>, <a class="code" href="common_8c.html#a7deca9feda010b78c6221c26d513befa" title="Convert radian to degree.">toDegree</a>(direction));</div>
<div class="line"><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="preprocessor"></span>    <a class="code" href="motor_8c.html#af7e3ae583d926f4c1a61df25c550d9a4" title="rotate the Pololu bot to an absolute bearing">motor_rot_abs</a>(<a class="code" href="common_8c.html#a7deca9feda010b78c6221c26d513befa" title="Convert radian to degree.">toDegree</a>(direction));</div>
<div class="line">    <a class="code" href="advanced__movement_8c.html#acb38670d4902890b481e832b39168537" title="Move the robot for certain distance.">adv_travel</a>(distance);</div>
<div class="line"><span class="preprocessor">    #ifdef ADV_MOV_DBG</span></div>
<div class="line"><span class="preprocessor"></span>    <a class="code" href="debug_8c.html#a5cac9a3a2f2d7c55aa4ede6ba71bf8be" title="printf function for the debugging console">dbg_printf</a>(<span class="stringliteral">&quot;ADV_MOVE: Finishing, Rotating to %f\r\n&quot;</span>, <a class="code" href="common_8c.html#a7deca9feda010b78c6221c26d513befa" title="Convert radian to degree.">toDegree</a>(target.<a class="code" href="structCoordinate.html#a693c0661e8533059d118149af18c4982" title="angle in radian">t</a>));</div>
<div class="line"><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="preprocessor"></span>    <a class="code" href="motor_8c.html#af7e3ae583d926f4c1a61df25c550d9a4" title="rotate the Pololu bot to an absolute bearing">motor_rot_abs</a>(<a class="code" href="common_8c.html#a7deca9feda010b78c6221c26d513befa" title="Convert radian to degree.">toDegree</a>(target.<a class="code" href="structCoordinate.html#a693c0661e8533059d118149af18c4982" title="angle in radian">t</a>));</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="advanced__movement_8h_a1f84062caee0d0c04e26c0a5ed5aa6f5_cgraph.png" border="0" usemap="#advanced__movement_8h_a1f84062caee0d0c04e26c0a5ed5aa6f5_cgraph" alt=""/></div>
<map name="advanced__movement_8h_a1f84062caee0d0c04e26c0a5ed5aa6f5_cgraph" id="advanced__movement_8h_a1f84062caee0d0c04e26c0a5ed5aa6f5_cgraph">
<area shape="rect" id="node3" href="advanced__movement_8c.html#acb38670d4902890b481e832b39168537" title="Move the robot for certain distance." alt="" coords="476,112,559,141"/><area shape="rect" id="node9" href="debug_8c.html#a5cac9a3a2f2d7c55aa4ede6ba71bf8be" title="printf function for the debugging console" alt="" coords="793,268,871,297"/><area shape="rect" id="node25" href="coordinate_8c.html#af0c0898bb2b39bd4946e5c9a0911971d" title="read global coordinate record" alt="" coords="136,269,251,299"/><area shape="rect" id="node28" href="motor_8c.html#af7e3ae583d926f4c1a61df25c550d9a4" title="rotate the Pololu bot to an absolute bearing" alt="" coords="141,323,245,352"/><area shape="rect" id="node48" href="common_8c.html#a7deca9feda010b78c6221c26d513befa" title="Convert radian to degree." alt="" coords="156,376,231,405"/><area shape="rect" id="node5" href="coordinate_8c.html#a5904eb71d7fc2687a693f0518775cb5a" title="clear distance record." alt="" coords="637,59,744,88"/><area shape="rect" id="node7" href="coordinate_8c.html#a006f5a8a7a96dd826d00b123b2e36bc3" title="read total distance travelled" alt="" coords="640,165,741,195"/><area shape="rect" id="node11" href="motor_8c.html#a9327d3b425e2e0e49630118f7153eb60" title="Move both motors." alt="" coords="640,5,741,35"/><area shape="rect" id="node22" href="motor_8c.html#a2028f6e7acaeca3139534961fb804889" title="Stop both motors." alt="" coords="644,112,737,141"/><area shape="rect" id="node13" href="motor_8c.html#a6b8738722a7fad99c5e6b9be4e53d1b7" title="Speed limiter." alt="" coords="936,60,1043,89"/><area shape="rect" id="node15" href="motor_8c.html#ad61876852438f35d82769b704e6e8e37" title="Set motor speed." alt="" coords="792,99,872,128"/><area shape="rect" id="node18" href="motor_8c.html#a0bc2624928b5e9869ce6946fb2042fd8" title="private function: send a command to motor" alt="" coords="920,277,1059,307"/><area shape="rect" id="node20" href="uart_8c.html#abfe57cac5619ef3c3aa92250740e3cc5" title="Blocking send function." alt="" coords="1108,277,1209,307"/><area shape="rect" id="node31" href="motor_8c.html#a165ba685afbdce0d677ac8a7590b6fe8" title="rotate the Pololu bot for arbitary angle" alt="" coords="299,323,397,352"/><area shape="rect" id="node34" href="motor_8c.html#a606e6907b3fff0731c1127b8b1eff8a2" title="private function: command the motor to rotate" alt="" coords="445,371,589,400"/><area shape="rect" id="node38" href="delay_8c.html#ae3bfb8c0842af8292407895c45f944ff" title="Delay function." alt="" coords="648,421,733,451"/><area shape="rect" id="node41" href="led_8c.html#a6a4bc26a21ab305b8080a6d37726955f" title="Turn on certain LED." alt="" coords="803,428,861,457"/><area shape="rect" id="node43" href="delay_8c.html#a2bebcf384b8e8defe62a69d800dee00f" title="delay_init" alt="" coords="793,321,871,351"/><area shape="rect" id="node45" href="led_8c.html#a332be2958bf709819b7853ee7fe9372e" title="Turn off certain LED." alt="" coords="801,375,863,404"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a32ecfecc38758df0d69b18aafa5cc470"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adv_move_pid </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structCoordinate.html">Coordinate</a>&#160;</td>
          <td class="paramname"><em>target</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Implementing function for straight line movement (based on mouse data) </p>
<p>This version is similar to adv_move, except it uses the PID algorithm to travel in a straight line. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">target</td><td>the target coordinate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Fufu Fang (basically wrapped around Sam's adv_move_pid_polar) </dd></dl>

<p>Definition at line <a class="el" href="advanced__movement_8c_source.html#l00126">126</a> of file <a class="el" href="advanced__movement_8c_source.html">advanced_movement.c</a>.</p>

<p>References <a class="el" href="advanced__movement_8c_source.html#l00100">adv_move_pid_polar()</a>, <a class="el" href="coordinate_8c_source.html#l00088">coordinate_read()</a>, <a class="el" href="motor_8c_source.html#l00285">motor_rot_abs()</a>, <a class="el" href="coordinate_8h_source.html#l00020">Coordinate::t</a>, <a class="el" href="common_8c_source.html#l00016">toDegree()</a>, <a class="el" href="coordinate_8h_source.html#l00018">Coordinate::x</a>, and <a class="el" href="coordinate_8h_source.html#l00019">Coordinate::y</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <a class="code" href="structCoordinate.html" title="Coordinate record structure.">Coordinate</a> current = <a class="code" href="coordinate_8c.html#af0c0898bb2b39bd4946e5c9a0911971d" title="read global coordinate record">coordinate_read</a>();</div>
<div class="line">    <span class="keywordtype">int</span> dx = target.<a class="code" href="structCoordinate.html#a514c8968b1d03f65e76c9cc9566ee4cc" title="distance of x in cm">x</a> - current.<a class="code" href="structCoordinate.html#a514c8968b1d03f65e76c9cc9566ee4cc" title="distance of x in cm">x</a>;</div>
<div class="line">    <span class="keywordtype">int</span> dy = target.<a class="code" href="structCoordinate.html#a1a7d11305e68c5bfba2b9d4569d4b6ef" title="distance of y in cm">y</a> - current.<a class="code" href="structCoordinate.html#a1a7d11305e68c5bfba2b9d4569d4b6ef" title="distance of y in cm">y</a>;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* defensive programming, error avoidance) */</span></div>
<div class="line">    <span class="keywordflow">if</span> ( (dy == 0) &amp;&amp; (dx == 0) ){</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">float</span> distance= sqrt(dx*dx + dy*dy);</div>
<div class="line">    <span class="keywordtype">int</span> bearing = <a class="code" href="common_8c.html#a7deca9feda010b78c6221c26d513befa" title="Convert radian to degree.">toDegree</a>(atan2(dy, dx));</div>
<div class="line"></div>
<div class="line">    <a class="code" href="advanced__movement_8c.html#a5a94e3d9dce99e8d81d51515fa9c3ed6" title="Rotate and move (PID version)">adv_move_pid_polar</a>(distance, bearing);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="motor_8c.html#af7e3ae583d926f4c1a61df25c550d9a4" title="rotate the Pololu bot to an absolute bearing">motor_rot_abs</a>(<a class="code" href="common_8c.html#a7deca9feda010b78c6221c26d513befa" title="Convert radian to degree.">toDegree</a>(target.<a class="code" href="structCoordinate.html#a693c0661e8533059d118149af18c4982" title="angle in radian">t</a>));</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="advanced__movement_8h_a32ecfecc38758df0d69b18aafa5cc470_cgraph.png" border="0" usemap="#advanced__movement_8h_a32ecfecc38758df0d69b18aafa5cc470_cgraph" alt=""/></div>
<map name="advanced__movement_8h_a32ecfecc38758df0d69b18aafa5cc470_cgraph" id="advanced__movement_8h_a32ecfecc38758df0d69b18aafa5cc470_cgraph">
<area shape="rect" id="node3" href="advanced__movement_8c.html#a5a94e3d9dce99e8d81d51515fa9c3ed6" title="Rotate and move (PID version)" alt="" coords="160,134,301,164"/><area shape="rect" id="node13" href="motor_8c.html#af7e3ae583d926f4c1a61df25c550d9a4" title="rotate the Pololu bot to an absolute bearing" alt="" coords="371,265,475,294"/><area shape="rect" id="node50" href="coordinate_8c.html#af0c0898bb2b39bd4946e5c9a0911971d" title="read global coordinate record" alt="" coords="173,277,288,306"/><area shape="rect" id="node53" href="common_8c.html#a7deca9feda010b78c6221c26d513befa" title="Convert radian to degree." alt="" coords="193,330,268,360"/><area shape="rect" id="node5" href="coordinate_8c.html#a0eb693d2c1563217c6ffdde7433a5c78" title="set the target angle for the pid line following algorithm" alt="" coords="351,108,495,137"/><area shape="rect" id="node7" href="coordinate_8c.html#a5904eb71d7fc2687a693f0518775cb5a" title="clear distance record." alt="" coords="369,161,476,190"/><area shape="rect" id="node9" href="coordinate_8c.html#a006f5a8a7a96dd826d00b123b2e36bc3" title="read total distance travelled" alt="" coords="545,109,647,138"/><area shape="rect" id="node35" href="motor_8c.html#a2028f6e7acaeca3139534961fb804889" title="Stop both motors." alt="" coords="893,54,987,84"/><area shape="rect" id="node43" href="pid_8c.html#ab531cfd7d1c40cfa8e21b93ceb11561b" title="Factored out PID calculation function." alt="" coords="733,212,803,241"/><area shape="rect" id="node46" href="pid_8c.html#a7e9bbca6d16b9f5ff554e593c3a52f57" title="Set Motors move fwd based on PID result." alt="" coords="888,108,992,137"/><area shape="rect" id="node11" href="debug_8c.html#a5cac9a3a2f2d7c55aa4ede6ba71bf8be" title="printf function for the debugging console" alt="" coords="1041,264,1119,293"/><area shape="rect" id="node16" href="motor_8c.html#a165ba685afbdce0d677ac8a7590b6fe8" title="rotate the Pololu bot for arbitary angle" alt="" coords="547,316,645,345"/><area shape="rect" id="node19" href="motor_8c.html#a606e6907b3fff0731c1127b8b1eff8a2" title="private function: command the motor to rotate" alt="" coords="696,366,840,396"/><area shape="rect" id="node22" href="motor_8c.html#a0bc2624928b5e9869ce6946fb2042fd8" title="private function: send a command to motor" alt="" coords="1168,288,1307,317"/><area shape="rect" id="node26" href="delay_8c.html#ae3bfb8c0842af8292407895c45f944ff" title="Delay function." alt="" coords="897,468,983,497"/><area shape="rect" id="node24" href="uart_8c.html#abfe57cac5619ef3c3aa92250740e3cc5" title="Blocking send function." alt="" coords="1356,288,1457,317"/><area shape="rect" id="node29" href="led_8c.html#a6a4bc26a21ab305b8080a6d37726955f" title="Turn on certain LED." alt="" coords="1051,521,1109,550"/><area shape="rect" id="node31" href="delay_8c.html#a2bebcf384b8e8defe62a69d800dee00f" title="delay_init" alt="" coords="1041,574,1119,604"/><area shape="rect" id="node33" href="led_8c.html#a332be2958bf709819b7853ee7fe9372e" title="Turn off certain LED." alt="" coords="1049,468,1111,497"/><area shape="rect" id="node37" href="motor_8c.html#ad61876852438f35d82769b704e6e8e37" title="Set motor speed." alt="" coords="1040,108,1120,137"/><area shape="rect" id="node39" href="motor_8c.html#a6b8738722a7fad99c5e6b9be4e53d1b7" title="Speed limiter." alt="" coords="1184,108,1291,137"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5a94e3d9dce99e8d81d51515fa9c3ed6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adv_move_pid_polar </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bearing</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate and move (PID version) </p>
<p>This version is similar to adv_move_polar, except it uses the PID algorithm to travel in a straight line. </p>
<dl class="section author"><dt>Author</dt><dd>Sam Gamble </dd></dl>

<p>Definition at line <a class="el" href="advanced__movement_8c_source.html#l00100">100</a> of file <a class="el" href="advanced__movement_8c_source.html">advanced_movement.c</a>.</p>

<p>References <a class="el" href="coordinate_8c_source.html#l00029">coordinate_angle_set()</a>, <a class="el" href="coordinate_8c_source.html#l00093">distance_clear()</a>, <a class="el" href="coordinate_8c_source.html#l00098">distance_read()</a>, <a class="el" href="advanced__movement_8c_source.html#l00031">g_exit_flag</a>, <a class="el" href="advanced__movement_8c_source.html#l00030">g_pid_angle</a>, <a class="el" href="motor_8c_source.html#l00285">motor_rot_abs()</a>, <a class="el" href="motor_8c_source.html#l00231">motors_stop()</a>, <a class="el" href="pid_8c_source.html#l00382">pid_calc()</a>, and <a class="el" href="pid_8c_source.html#l00403">pid_motor_set()</a>.</p>

<p>Referenced by <a class="el" href="advanced__movement_8c_source.html#l00126">adv_move_pid()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>( (distance&lt; 1) || (bearing &lt; 0) || (bearing &gt; 360) ){</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">int</span> last_p      = 0;</div>
<div class="line">    <span class="keywordtype">int</span> i           = 0;</div>
<div class="line">    <span class="keywordtype">int</span> d           = 0;</div>
<div class="line">    <span class="keywordtype">int</span> power_diff  = 0;</div>
<div class="line">    <span class="keywordtype">float</span> travelled = 0;</div>
<div class="line">    <a class="code" href="advanced__movement_8c.html#a2bc032c2ec766050ea8081ff97b533ea">g_exit_flag</a>   = 0;</div>
<div class="line"></div>
<div class="line">    <a class="code" href="coordinate_8c.html#a0eb693d2c1563217c6ffdde7433a5c78" title="set the target angle for the pid line following algorithm">coordinate_angle_set</a>(bearing);</div>
<div class="line">    <a class="code" href="motor_8c.html#af7e3ae583d926f4c1a61df25c550d9a4" title="rotate the Pololu bot to an absolute bearing">motor_rot_abs</a>(bearing);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="coordinate_8c.html#a5904eb71d7fc2687a693f0518775cb5a" title="clear distance record.">distance_clear</a>();</div>
<div class="line">    <span class="keywordflow">while</span>(travelled &lt;= distance &amp;&amp; !<a class="code" href="advanced__movement_8c.html#a2bc032c2ec766050ea8081ff97b533ea">g_exit_flag</a>){</div>
<div class="line">        travelled = <a class="code" href="coordinate_8c.html#a006f5a8a7a96dd826d00b123b2e36bc3" title="read total distance travelled">distance_read</a>();</div>
<div class="line"></div>
<div class="line">        power_diff = <a class="code" href="pid_8c.html#ab531cfd7d1c40cfa8e21b93ceb11561b" title="Factored out PID calculation function.">pid_calc</a>(<a class="code" href="advanced__movement_8c.html#a264d5899006eccc0190c0fe9a9370e27">g_pid_angle</a>, &amp;last_p, &amp;i, &amp;d);</div>
<div class="line">        <a class="code" href="pid_8c.html#a7e9bbca6d16b9f5ff554e593c3a52f57" title="Set Motors move fwd based on PID result.">pid_motor_set</a>(power_diff);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="motor_8c.html#a2028f6e7acaeca3139534961fb804889" title="Stop both motors.">motors_stop</a>();</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="advanced__movement_8h_a5a94e3d9dce99e8d81d51515fa9c3ed6_cgraph.png" border="0" usemap="#advanced__movement_8h_a5a94e3d9dce99e8d81d51515fa9c3ed6_cgraph" alt=""/></div>
<map name="advanced__movement_8h_a5a94e3d9dce99e8d81d51515fa9c3ed6_cgraph" id="advanced__movement_8h_a5a94e3d9dce99e8d81d51515fa9c3ed6_cgraph">
<area shape="rect" id="node3" href="coordinate_8c.html#a0eb693d2c1563217c6ffdde7433a5c78" title="set the target angle for the pid line following algorithm" alt="" coords="196,5,340,35"/><area shape="rect" id="node5" href="coordinate_8c.html#a5904eb71d7fc2687a693f0518775cb5a" title="clear distance record." alt="" coords="215,59,321,88"/><area shape="rect" id="node7" href="coordinate_8c.html#a006f5a8a7a96dd826d00b123b2e36bc3" title="read total distance travelled" alt="" coords="391,59,492,88"/><area shape="rect" id="node11" href="motor_8c.html#af7e3ae583d926f4c1a61df25c550d9a4" title="rotate the Pololu bot to an absolute bearing" alt="" coords="216,163,320,192"/><area shape="rect" id="node33" href="motor_8c.html#a2028f6e7acaeca3139534961fb804889" title="Stop both motors." alt="" coords="739,472,832,501"/><area shape="rect" id="node41" href="pid_8c.html#ab531cfd7d1c40cfa8e21b93ceb11561b" title="Factored out PID calculation function." alt="" coords="579,213,648,243"/><area shape="rect" id="node44" href="pid_8c.html#a7e9bbca6d16b9f5ff554e593c3a52f57" title="Set Motors move fwd based on PID result." alt="" coords="733,419,837,448"/><area shape="rect" id="node9" href="debug_8c.html#a5cac9a3a2f2d7c55aa4ede6ba71bf8be" title="printf function for the debugging console" alt="" coords="887,159,964,188"/><area shape="rect" id="node14" href="motor_8c.html#a165ba685afbdce0d677ac8a7590b6fe8" title="rotate the Pololu bot for arbitary angle" alt="" coords="392,163,491,192"/><area shape="rect" id="node17" href="motor_8c.html#a606e6907b3fff0731c1127b8b1eff8a2" title="private function: command the motor to rotate" alt="" coords="541,315,685,344"/><area shape="rect" id="node20" href="motor_8c.html#a0bc2624928b5e9869ce6946fb2042fd8" title="private function: send a command to motor" alt="" coords="1013,371,1152,400"/><area shape="rect" id="node24" href="delay_8c.html#ae3bfb8c0842af8292407895c45f944ff" title="Delay function." alt="" coords="743,315,828,344"/><area shape="rect" id="node22" href="uart_8c.html#abfe57cac5619ef3c3aa92250740e3cc5" title="Blocking send function." alt="" coords="1201,371,1303,400"/><area shape="rect" id="node27" href="led_8c.html#a6a4bc26a21ab305b8080a6d37726955f" title="Turn on certain LED." alt="" coords="896,212,955,241"/><area shape="rect" id="node29" href="delay_8c.html#a2bebcf384b8e8defe62a69d800dee00f" title="delay_init" alt="" coords="887,265,964,295"/><area shape="rect" id="node31" href="led_8c.html#a332be2958bf709819b7853ee7fe9372e" title="Turn off certain LED." alt="" coords="895,319,956,348"/><area shape="rect" id="node35" href="motor_8c.html#ad61876852438f35d82769b704e6e8e37" title="Set motor speed." alt="" coords="885,424,965,453"/><area shape="rect" id="node37" href="motor_8c.html#a6b8738722a7fad99c5e6b9be4e53d1b7" title="Speed limiter." alt="" coords="1029,424,1136,453"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="advanced__movement_8h_a5a94e3d9dce99e8d81d51515fa9c3ed6_icgraph.png" border="0" usemap="#advanced__movement_8h_a5a94e3d9dce99e8d81d51515fa9c3ed6_icgraph" alt=""/></div>
<map name="advanced__movement_8h_a5a94e3d9dce99e8d81d51515fa9c3ed6_icgraph" id="advanced__movement_8h_a5a94e3d9dce99e8d81d51515fa9c3ed6_icgraph">
<area shape="rect" id="node3" href="advanced__movement_8h.html#a32ecfecc38758df0d69b18aafa5cc470" title="Implementing function for straight line movement (based on mouse data)" alt="" coords="195,5,301,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4bbd42daaf19c44d051e1afde0a09576"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adv_move_polar </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>distance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bearing</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rotate and move (Non-PID version) </p>
<p>Rotates to face desired angle of travel, then travel for a desired distance </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">'distance'</td><td>Distance of the straight line to follow (in cm) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">'bearing'</td><td>the target bearing for the robot (in degrees) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Fufu Fang </dd></dl>

<p>Definition at line <a class="el" href="advanced__movement_8c_source.html#l00065">65</a> of file <a class="el" href="advanced__movement_8c_source.html">advanced_movement.c</a>.</p>

<p>References <a class="el" href="advanced__movement_8c_source.html#l00051">adv_travel()</a>, and <a class="el" href="motor_8c_source.html#l00285">motor_rot_abs()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <a class="code" href="motor_8c.html#af7e3ae583d926f4c1a61df25c550d9a4" title="rotate the Pololu bot to an absolute bearing">motor_rot_abs</a>(bearing);</div>
<div class="line">    <a class="code" href="advanced__movement_8c.html#acb38670d4902890b481e832b39168537" title="Move the robot for certain distance.">adv_travel</a>(distance);</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="advanced__movement_8h_a4bbd42daaf19c44d051e1afde0a09576_cgraph.png" border="0" usemap="#advanced__movement_8h_a4bbd42daaf19c44d051e1afde0a09576_cgraph" alt=""/></div>
<map name="advanced__movement_8h_a4bbd42daaf19c44d051e1afde0a09576_cgraph" id="advanced__movement_8h_a4bbd42daaf19c44d051e1afde0a09576_cgraph">
<area shape="rect" id="node3" href="advanced__movement_8c.html#acb38670d4902890b481e832b39168537" title="Move the robot for certain distance." alt="" coords="503,112,585,141"/><area shape="rect" id="node25" href="motor_8c.html#af7e3ae583d926f4c1a61df25c550d9a4" title="rotate the Pololu bot to an absolute bearing" alt="" coords="172,217,276,247"/><area shape="rect" id="node5" href="coordinate_8c.html#a5904eb71d7fc2687a693f0518775cb5a" title="clear distance record." alt="" coords="664,5,771,35"/><area shape="rect" id="node7" href="coordinate_8c.html#a006f5a8a7a96dd826d00b123b2e36bc3" title="read total distance travelled" alt="" coords="667,112,768,141"/><area shape="rect" id="node11" href="motor_8c.html#a9327d3b425e2e0e49630118f7153eb60" title="Move both motors." alt="" coords="667,59,768,88"/><area shape="rect" id="node22" href="motor_8c.html#a2028f6e7acaeca3139534961fb804889" title="Stop both motors." alt="" coords="671,165,764,195"/><area shape="rect" id="node9" href="debug_8c.html#a5cac9a3a2f2d7c55aa4ede6ba71bf8be" title="printf function for the debugging console" alt="" coords="820,217,897,247"/><area shape="rect" id="node13" href="motor_8c.html#a6b8738722a7fad99c5e6b9be4e53d1b7" title="Speed limiter." alt="" coords="963,105,1069,135"/><area shape="rect" id="node15" href="motor_8c.html#ad61876852438f35d82769b704e6e8e37" title="Set motor speed." alt="" coords="819,137,899,167"/><area shape="rect" id="node18" href="motor_8c.html#a0bc2624928b5e9869ce6946fb2042fd8" title="private function: send a command to motor" alt="" coords="947,277,1085,307"/><area shape="rect" id="node20" href="uart_8c.html#abfe57cac5619ef3c3aa92250740e3cc5" title="Blocking send function." alt="" coords="1135,277,1236,307"/><area shape="rect" id="node28" href="motor_8c.html#a165ba685afbdce0d677ac8a7590b6fe8" title="rotate the Pololu bot for arbitary angle" alt="" coords="325,269,424,299"/><area shape="rect" id="node31" href="motor_8c.html#a606e6907b3fff0731c1127b8b1eff8a2" title="private function: command the motor to rotate" alt="" coords="472,320,616,349"/><area shape="rect" id="node35" href="delay_8c.html#ae3bfb8c0842af8292407895c45f944ff" title="Delay function." alt="" coords="675,371,760,400"/><area shape="rect" id="node38" href="led_8c.html#a6a4bc26a21ab305b8080a6d37726955f" title="Turn on certain LED." alt="" coords="829,377,888,407"/><area shape="rect" id="node40" href="delay_8c.html#a2bebcf384b8e8defe62a69d800dee00f" title="delay_init" alt="" coords="820,271,897,300"/><area shape="rect" id="node42" href="led_8c.html#a332be2958bf709819b7853ee7fe9372e" title="Turn off certain LED." alt="" coords="828,324,889,353"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6846eb629cadb04c4e4b9ad3fda2ad44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adv_print_rmp </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print readings from <a class="el" href="structRPM.html" title="Motor RPM record structure.">RPM</a>. </p>
<dl class="section author"><dt>Author</dt><dd>Sam Gamble</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Motor speed 30: Walked 50cm in 3000 ms 17cm/s wheel diameter(3.2)*pi = circumference of 10.05cm = 1.7 revs per sec = 102 <a class="el" href="structRPM.html" title="Motor RPM record structure.">RPM</a></dd></dl>
<p>30/100 (approx) = 0.3 so &ndash;&gt; moter speed diff = 0.3 * (target_rpm - measured_rpm)</p>
<p>Note: intergal part might not be needed (pending testing)</p>
<p>tested with dt = 0.1 in gcc and got crazy high values (exlude for now)</p>
<p>= *=tuning the system== First set I and D to 0. Find a good P term that gives a quick response, but will have oscillations. Then find a D to reduce oscillations. stay away from the I term for your system. Keep I = 0, for now, and tell me how your systems looks. </p>

<p>Definition at line <a class="el" href="advanced__movement_8c_source.html#l00167">167</a> of file <a class="el" href="advanced__movement_8c_source.html">advanced_movement.c</a>.</p>

<p>References <a class="el" href="debug_8c_source.html#l00016">dbg_printf()</a>, <a class="el" href="odometry_8h_source.html#l00025">RPM::left</a>, and <a class="el" href="odometry_8h_source.html#l00026">RPM::right</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <a class="code" href="debug_8c.html#a5cac9a3a2f2d7c55aa4ede6ba71bf8be" title="printf function for the debugging console">dbg_printf</a>(<span class="stringliteral">&quot;l_rpm_measured: %f   l_rpm_measured: %f\r\n&quot;</span> ,<a class="code" href="advanced__movement_8c.html#af5b0c7c50a70c6118aa12887fee0e722">g_rpm</a>.<a class="code" href="structRPM.html#a4caca26b4332b8a38bd0268e015519c8" title="rpm of left motor">left</a> ,<a class="code" href="advanced__movement_8c.html#af5b0c7c50a70c6118aa12887fee0e722">g_rpm</a>.<a class="code" href="structRPM.html#aacfc09ab6ae0ab2e58f30d0e4c7e9bfe" title="rpm of right motor">right</a>);</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="advanced__movement_8h_a6846eb629cadb04c4e4b9ad3fda2ad44_cgraph.png" border="0" usemap="#advanced__movement_8h_a6846eb629cadb04c4e4b9ad3fda2ad44_cgraph" alt=""/></div>
<map name="advanced__movement_8h_a6846eb629cadb04c4e4b9ad3fda2ad44_cgraph" id="advanced__movement_8h_a6846eb629cadb04c4e4b9ad3fda2ad44_cgraph">
<area shape="rect" id="node3" href="debug_8c.html#a5cac9a3a2f2d7c55aa4ede6ba71bf8be" title="printf function for the debugging console" alt="" coords="159,5,236,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3e41f7d4e342aa8ea83f905cb3cbd7d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adv_rpm_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structRPM.html">RPM</a>&#160;</td>
          <td class="paramname"><em>rpm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>update the local rpm record </p>
<p><a class="el" href="odometry_8c.html" title="Wheel encoder based odometry module (source)">odometry.c</a> calls this function when there is a new rpm update. </p>

<p>Definition at line <a class="el" href="advanced__movement_8c_source.html#l00035">35</a> of file <a class="el" href="advanced__movement_8c_source.html">advanced_movement.c</a>.</p>

<p>References <a class="el" href="odometry_8h_source.html#l00025">RPM::left</a>, and <a class="el" href="odometry_8h_source.html#l00026">RPM::right</a>.</p>

<p>Referenced by <a class="el" href="odometry_8c_source.html#l00174">TIMER3_IRQHandler()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <a class="code" href="advanced__movement_8c.html#af5b0c7c50a70c6118aa12887fee0e722">g_rpm</a>.<a class="code" href="structRPM.html#a4caca26b4332b8a38bd0268e015519c8" title="rpm of left motor">left</a> = rpm.<a class="code" href="structRPM.html#a4caca26b4332b8a38bd0268e015519c8" title="rpm of left motor">left</a>;</div>
<div class="line">    <a class="code" href="advanced__movement_8c.html#af5b0c7c50a70c6118aa12887fee0e722">g_rpm</a>.<a class="code" href="structRPM.html#aacfc09ab6ae0ab2e58f30d0e4c7e9bfe" title="rpm of right motor">right</a> = rpm.<a class="code" href="structRPM.html#aacfc09ab6ae0ab2e58f30d0e4c7e9bfe" title="rpm of right motor">right</a>;</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="advanced__movement_8h_a3e41f7d4e342aa8ea83f905cb3cbd7d0_icgraph.png" border="0" usemap="#advanced__movement_8h_a3e41f7d4e342aa8ea83f905cb3cbd7d0_icgraph" alt=""/></div>
<map name="advanced__movement_8h_a3e41f7d4e342aa8ea83f905cb3cbd7d0_icgraph" id="advanced__movement_8h_a3e41f7d4e342aa8ea83f905cb3cbd7d0_icgraph">
<area shape="rect" id="node3" href="odometry_8h.html#a2ddf55575e8a87bb370480c425f8519c" title="Interrupt service routine for Timer 3." alt="" coords="173,5,320,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acb38670d4902890b481e832b39168537"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void adv_travel </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>distance</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Move the robot for certain distance. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">distance</td><td>the distance to move in cm. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section author"><dt>Author</dt><dd>Fufu Fang </dd></dl>

<p>Definition at line <a class="el" href="advanced__movement_8c_source.html#l00051">51</a> of file <a class="el" href="advanced__movement_8c_source.html">advanced_movement.c</a>.</p>

<p>References <a class="el" href="coordinate_8c_source.html#l00093">distance_clear()</a>, <a class="el" href="coordinate_8c_source.html#l00098">distance_read()</a>, <a class="el" href="advanced__movement_8c_source.html#l00031">g_exit_flag</a>, <a class="el" href="motor_8c_source.html#l00237">motors_move()</a>, <a class="el" href="motor_8c_source.html#l00231">motors_stop()</a>, and <a class="el" href="motor_8h_source.html#l00029">SPEED_LIMIT</a>.</p>

<p>Referenced by <a class="el" href="advanced__movement_8c_source.html#l00076">adv_move()</a>, and <a class="el" href="advanced__movement_8c_source.html#l00065">adv_move_polar()</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (distance == 0) {</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">float</span> travelled = 0;</div>
<div class="line">    <a class="code" href="coordinate_8c.html#a5904eb71d7fc2687a693f0518775cb5a" title="clear distance record.">distance_clear</a>();</div>
<div class="line">    <a class="code" href="motor_8c.html#a9327d3b425e2e0e49630118f7153eb60" title="Move both motors.">motors_move</a>(<a class="code" href="motor_8h.html#acce419d129f6df99618eb8f81d7184a7">SPEED_LIMIT</a>);</div>
<div class="line">    <span class="keywordflow">while</span>(travelled &lt;= distance &amp;&amp; !<a class="code" href="advanced__movement_8c.html#a2bc032c2ec766050ea8081ff97b533ea">g_exit_flag</a>) {</div>
<div class="line">        travelled = <a class="code" href="coordinate_8c.html#a006f5a8a7a96dd826d00b123b2e36bc3" title="read total distance travelled">distance_read</a>();</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="motor_8c.html#a2028f6e7acaeca3139534961fb804889" title="Stop both motors.">motors_stop</a>();</div>
<div class="line">}</div>
</div><!-- fragment -->
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="advanced__movement_8h_acb38670d4902890b481e832b39168537_cgraph.png" border="0" usemap="#advanced__movement_8h_acb38670d4902890b481e832b39168537_cgraph" alt=""/></div>
<map name="advanced__movement_8h_acb38670d4902890b481e832b39168537_cgraph" id="advanced__movement_8h_acb38670d4902890b481e832b39168537_cgraph">
<area shape="rect" id="node3" href="coordinate_8c.html#a5904eb71d7fc2687a693f0518775cb5a" title="clear distance record." alt="" coords="136,5,243,35"/><area shape="rect" id="node5" href="coordinate_8c.html#a006f5a8a7a96dd826d00b123b2e36bc3" title="read total distance travelled" alt="" coords="139,59,240,88"/><area shape="rect" id="node9" href="motor_8c.html#a9327d3b425e2e0e49630118f7153eb60" title="Move both motors." alt="" coords="139,112,240,141"/><area shape="rect" id="node20" href="motor_8c.html#a2028f6e7acaeca3139534961fb804889" title="Stop both motors." alt="" coords="143,165,236,195"/><area shape="rect" id="node7" href="debug_8c.html#a5cac9a3a2f2d7c55aa4ede6ba71bf8be" title="printf function for the debugging console" alt="" coords="292,59,369,88"/><area shape="rect" id="node11" href="motor_8c.html#a6b8738722a7fad99c5e6b9be4e53d1b7" title="Speed limiter." alt="" coords="435,112,541,141"/><area shape="rect" id="node13" href="motor_8c.html#ad61876852438f35d82769b704e6e8e37" title="Set motor speed." alt="" coords="291,165,371,195"/><area shape="rect" id="node16" href="motor_8c.html#a0bc2624928b5e9869ce6946fb2042fd8" title="private function: send a command to motor" alt="" coords="419,165,557,195"/><area shape="rect" id="node18" href="uart_8c.html#abfe57cac5619ef3c3aa92250740e3cc5" title="Blocking send function." alt="" coords="607,165,708,195"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="advanced__movement_8h_acb38670d4902890b481e832b39168537_icgraph.png" border="0" usemap="#advanced__movement_8h_acb38670d4902890b481e832b39168537_icgraph" alt=""/></div>
<map name="advanced__movement_8h_acb38670d4902890b481e832b39168537_icgraph" id="advanced__movement_8h_acb38670d4902890b481e832b39168537_icgraph">
<area shape="rect" id="node3" href="advanced__movement_8h.html#a1f84062caee0d0c04e26c0a5ed5aa6f5" title="move to a location (Non&#45;PID version)" alt="" coords="153,5,236,35"/><area shape="rect" id="node5" href="advanced__movement_8h.html#a4bbd42daaf19c44d051e1afde0a09576" title="Rotate and move (Non&#45;PID version)" alt="" coords="136,59,253,88"/></map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 23 2013 15:57:25 for Team Rocket Robotics by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1.2
</small></address>
</body>
</html>
